<!DOCTYPE html>

<html>

<head></head>

<body>
    <h1>Login</h1>
    <form method="post" id="login-form" name="login-form">
        <input type="text" placeholder="username" name="username">
        <input type="password" placeholder="password" name="password">
        <input type="submit">
    </form>

    <script src="scripts/utils.js"></script>
    <script src="scripts/api.js"></script>
    <script>

        //if (sessionStorage.getItem("API_token") != null) {
        //    window.location.replace("index.html");
        //}

        const form = document.getElementById("login-form");

        form.addEventListener("submit", async function (event) {
            event.preventDefault();
            const form_data = new FormData(form);

            const response = await api_request("login", "POST", form_data);

            console.log(response);

            if (response.success == true) {
                sessionStorage.setItem("isLogged", true);
            }

            if (sessionStorage.getItem("isLogged") == 'true') {
                console.log("redirecting...");
                window.location.replace("index.html");
            }
        });



    </script>
</body>

</html>